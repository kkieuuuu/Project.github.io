--Tạo CSDL
CREATE DATABASE QUANLYBENHVIEN2
USE QUANLYBENHVIEN2

--Tạo tài khoản
CREATE TABLE TAIKHOAN
(
	TENDN		NVARCHAR (20) CONSTRAINT PK_TAIKHOAN PRIMARY KEY(TENDN),
	MATKHAU		VARCHAR (50),
	TENTK		NVARCHAR(50)
)

--KHOA
CREATE TABLE KHOA
(
	MAKHOA		NVARCHAR(6) CONSTRAINT PK_KHOA PRIMARY KEY(MAKHOA),
	TENKHOA		NVARCHAR(50),
	SDTKHOA		NVARCHAR(10)
)

--PHÒNG CHỨC NĂNG
CREATE TABLE PHONGCHUCNANG
(
	MAPH		NVARCHAR(6) CONSTRAINT PK_PHONGCHUCNANG PRIMARY KEY(MAPH),
	TENPH		NVARCHAR(50),
	SDTPH		NVARCHAR(10)
)

--CHỨC VỤ
CREATE TABLE CHUCVU
(
	MACV		NVARCHAR(6) CONSTRAINT PK_CHUCVU PRIMARY KEY(MACV),
	TENCV		NVARCHAR(50)
)

--ĐỐI TƯỢNG
CREATE TABLE DOITUONG
(
	MADT		NVARCHAR(6) CONSTRAINT PK_DOITUONG PRIMARY KEY(MADT),
	TENDT		NVARCHAR(100),
	MIENGIAM	FLOAT,
	DIEUKIEN	NVARCHAR(100)
)

--NHÂN VIÊN
CREATE TABLE NHANVIEN
(
	MANV		NVARCHAR(6) CONSTRAINT PK_NHANVIEN		PRIMARY KEY(MANV),
	MAPH		NVARCHAR(6) CONSTRAINT FK_NHANVIEN_MAPH FOREIGN KEY(MAPH) REFERENCES PHONGCHUCNANG(MAPH),
	MACV		NVARCHAR(6) CONSTRAINT FK_NHANVIEN_MACV FOREIGN KEY(MACV) REFERENCES CHUCVU(MACV),
	HOTENNV		NVARCHAR(100),
	GIOITINHNV	NVARCHAR(10) CONSTRAINT CK_GIOITINHNV_NHANVIEN CHECK (GIOITINHNV IN (N'Nam', N'Nữ', N'Khác')),
	CMNDNV		NVARCHAR(12),
	DIACHINV	NVARCHAR(100),
	NGAYSINHNV	DATETIME,
	SDTNV		NVARCHAR(10),
	EMAILNV		NVARCHAR(50),
	LUONGNV		FLOAT
)

--BÁC SĨ
CREATE TABLE BACSI
(
	MABS		NVARCHAR(6) CONSTRAINT PK_BACSI		   PRIMARY KEY(MABS),
	MAKHOA		NVARCHAR(6) CONSTRAINT FK_BACSI_MAKHOA FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA),
	MACV		NVARCHAR(6) CONSTRAINT FK_BACSI_MACV   FOREIGN KEY(MACV)   REFERENCES CHUCVU(MACV),
	HOTENBS		NVARCHAR(100),
	GIOITINHBS	NVARCHAR(10) CONSTRAINT CK_GIOITINHBS_BACSI CHECK (GIOITINHBS IN (N'Nam', N'Nữ', N'Khác')),
	CMNDBS		NVARCHAR(12),
	DIACHIBS	NVARCHAR(100),
	NGAYSINHBS	DATETIME,
	SDTBS		NVARCHAR(10),
	LUONGBS		FLOAT
)

--Y TÁ
CREATE TABLE YTA
(
	MAYT		NVARCHAR(6) CONSTRAINT PK_YTA		 PRIMARY KEY(MAYT),
	MAKHOA		NVARCHAR(6) CONSTRAINT FK_YTA_MAKHOA FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA),
	MACV		NVARCHAR(6) CONSTRAINT FK_YTA_MACV	 FOREIGN KEY(MACV)	 REFERENCES CHUCVU(MACV),
	HOTENYT		NVARCHAR(100),
	GIOITINHYT	NVARCHAR(10) CONSTRAINT CK_GIOITINHYT_YTA CHECK (GIOITINHYT IN (N'Nam', N'Nữ', N'Khác')),
	CMNDYT		NVARCHAR(12),
	DIACHIYT	NVARCHAR(100),
	NGAYSINHYT	DATETIME,
	SDTYT		NVARCHAR(10),
	LUONGYT		FLOAT
)

--NHÀ CUNG CẤP
CREATE TABLE NHACUNGCAP
(
	MANCC		NVARCHAR(6) CONSTRAINT PK_NHACUNGCAP PRIMARY KEY(MANCC),
	TENNCC		NVARCHAR(100),
	DIACHI		NVARCHAR(100),
	SDT			NVARCHAR(10),
	EMAIL		NVARCHAR(50),
	WEBSITE		NVARCHAR(100)
)

--HỒ SƠ THUỐC 
CREATE TABLE HOSOTHUOC
(
	MATHUOC		NVARCHAR(6) CONSTRAINT PK_HOSOTHUOC		  PRIMARY KEY(MATHUOC),
	MANCC		NVARCHAR(6) CONSTRAINT FK_HOSOTHUOC_MANCC FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC),
	TENTHUOC	NVARCHAR(50),
	NGAYSX		DATETIME,
	NGAYHETHAN	DATETIME,
	NGAYMUA		DATETIME,
	SLTHUOC		INTEGER,
	DVT			NVARCHAR(20),
	DGNHAP		FLOAT
)

--HỒ SƠ BỆNH ÁN
CREATE TABLE HOSOBENHAN
(
	MAHS				NVARCHAR(6) CONSTRAINT PK_HOSOBENHAN		PRIMARY KEY(MAHS),
	MABN				NVARCHAR(6) CONSTRAINT FK_HOSOBENHAN_MABN FOREIGN KEY(MABN) REFERENCES BENHNHAN(MABN),
	MAKHOA				NVARCHAR(6) CONSTRAINT FK_HOSOBENHAN_MAKHOA FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA),
	MAPDT				NVARCHAR(6) CONSTRAINT FK_HOSOBENHAN_MAPDT	FOREIGN KEY(MAPDT) REFERENCES PHIEUDIEUTRI(MAPDT),
	PHUONGPHAPDIEUTRI	NVARCHAR(100),
	PHANUNGPHU			NVARCHAR(50),
	KETQUA				NVARCHAR(50)
)
--BỆNH NHÂN
CREATE TABLE BENHNHAN
(
	MABN		NVARCHAR(6) CONSTRAINT PK_BENHNHAN		PRIMARY KEY(MABN),
	MADT		NVARCHAR(6) CONSTRAINT FK_BENHNHAN_MADT FOREIGN KEY(MADT) REFERENCES DOITUONG(MADT),
	HOTENBN     NVARCHAR(100),
	GIOITINHBN	NVARCHAR(10) CONSTRAINT CK_GIOITINHBN_BENHNHAN CHECK (GIOITINHBN IN (N'Nam', N'Nữ', N'Khác')),
	CMNDBN		NVARCHAR(12),
	DIACHIBN	NVARCHAR(100),
	NGAYSINHBN	DATETIME,
	SDTBN		NVARCHAR(10),
	EMAILBN		NVARCHAR(50)
)

--PHIẾU ĐIỀU TRỊ
CREATE TABLE PHIEUDIEUTRI
(
	MAPDT		NVARCHAR(6) CONSTRAINT PK_PHIEUDIEUTRI		PRIMARY KEY(MAPDT),
	MABN		NVARCHAR(6) CONSTRAINT FK_PHIEUDIEUTRI_MABN FOREIGN KEY(MABN) REFERENCES BENHNHAN (MABN),	
	NGAYKHAM	DATETIME,
	MOTA		NTEXT,
	KETLUAN		NTEXT
)

--TOA THUỐC
CREATE TABLE TOATHUOC
(
	MAPDT		NVARCHAR(6) CONSTRAINT FK_TOATHUOC_MAPDT	FOREIGN KEY(MAPDT)	 REFERENCES PHIEUDIEUTRI(MAPDT),
	MABN		NVARCHAR(6) CONSTRAINT FK_TOATHUOC_MABN		FOREIGN KEY(MABN)	 REFERENCES BENHNHAN(MABN),
	MABS		NVARCHAR(6) CONSTRAINT FK_TOATHUOC_MABS		FOREIGN KEY(MABS)	 REFERENCES BACSI(MABS),
	MATHUOC		NVARCHAR(6) CONSTRAINT FK_TOATHUOC_MATHUOC	FOREIGN KEY(MATHUOC) REFERENCES HOSOTHUOC(MATHUOC),
	CONSTRAINT PK_TOATHUOC PRIMARY KEY (MAPDT, MABN, MABS, MATHUOC),
	SOLAN		INTEGER,
	LIEULUONG	NVARCHAR(20)
)

--HÓA ĐƠN VIỆN PHÍ
CREATE TABLE HOADONVIENPHI
(
	MAHD		 NVARCHAR(6) CONSTRAINT PK_HOADONVIENPHI	  PRIMARY KEY(MAHD),
	MABN		 NVARCHAR(6) CONSTRAINT FK_HOADONVIENPHI_MABN FOREIGN KEY(MABN) REFERENCES BENHNHAN(MABN),
	MANV		 NVARCHAR(6) CONSTRAINT FK_HOADONVIENPHI_MANV FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV),
	NGAYKHAM	 DATETIME,
	NGAYLAYTHUOC DATETIME,
	HTTT		 NVARCHAR(20),
	THANHTIEN    FLOAT
)

--CHI TIẾT HÓA ĐƠN VIỆN PHÍ
CREATE TABLE CHITIETHOADON
(
	MAHD		NVARCHAR(6) CONSTRAINT FK_CTHD_MAHD	   FOREIGN KEY(MAHD)	REFERENCES HOADONVIENPHI(MAHD),
	MATHUOC		NVARCHAR(6) CONSTRAINT FK_CTHD_MATHUOC FOREIGN KEY(MATHUOC) REFERENCES HOSOTHUOC(MATHUOC),
	CONSTRAINT PK_CHITIETHOADON PRIMARY KEY (MAHD, MATHUOC),
	SOLUONG		INT,
	DGBAN		FLOAT
)

--BÁO CÁO
CREATE TABLE BAOCAO
(
	MABC NVARCHAR(6) CONSTRAINT PK_BAOCAO	    PRIMARY KEY(MABC),
	MANV NVARCHAR(6) CONSTRAINT FK_BAOCAO_MANV  FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV),
	TENBC NVARCHAR(100),
	NGAYLAP DATETIME,
	CHUTHICH NVARCHAR(100)
)

---Thêm dữ liệu bảng tài khoản
INSERT INTO TAIKHOAN 
VALUES	('ahsiu1234','123456',N'Trần Thủy Tiên'),
		('jasmint','123456',N'Nguyễn Cẩm Vy'),
		('lavender','123456',N'Nguyễn Phùng Vân Anh'),
		('kendall','123456',N'Lâm Hồ Thiên Tống'),
		('lily','123456',N'Phan Trung Hiếu'),
		('sun357','134567',N'Nguyễn Vũ Mẫn Nhi'),
		('Fired','123478',N'Hoàng Đức Nhã')

---Thêm dữ liệu bảng khoa
INSERT INTO KHOA
VALUES ('KPS',N'Khoa Phụ Sản','0987675567')
INSERT INTO KHOA
VALUES ('KN',N'Khoa Nhi ','0328769873')
INSERT INTO KHOA
VALUES ('KCC',N'Khoa Cấp Cứu','0897658732')
INSERT INTO KHOA
VALUES ('KXN',N'Khoa Xét Nghiệm','0978654732')
INSERT INTO KHOA
VALUES ('KRHM',N'Khoa Răng Hàm Mặt','0989768546')
INSERT INTO KHOA
VALUES ('KDL',N'Khoa Da Liễu','0989768542')
INSERT INTO KHOA
VALUES ('KTM',N'Khoa Thẩm Mỹ','0989768543')
INSERT INTO KHOA
VALUES ('KYHCT',N'Khoa Y Học Cổ Truyền','0989768556')
INSERT INTO KHOA
VALUES ('KCX',N'Khoa Cơ Xương Khớp','0989768526')
INSERT INTO KHOA
VALUES ('KTIM',N'Khoa Tim Mạch','0989768234')
INSERT INTO KHOA
VALUES ('KTK',N'Khoa Thần Kinh','0989768797')

--Thêm dữ liệu bảng phòng chức năng
INSERT INTO PHONGCHUCNANG
VALUES ('PKT',N'Phòng kế toán ','0989761243')
INSERT INTO PHONGCHUCNANG
VALUES ('PLTHS',N'Phòng lưu trữ hồ sơ','0989761244')
INSERT INTO PHONGCHUCNANG
VALUES ('PDD',N'Phòng điều dưỡng','0989761245')
INSERT INTO PHONGCHUCNANG
VALUES ('PHC',N'Phòng hành chính ','0989761242')
INSERT INTO PHONGCHUCNANG
VALUES ('PDT',N'Phòng đào tạo ','0989761241')
INSERT INTO PHONGCHUCNANG
VALUES ('PKH',N'Phòng kế hoạch ','0989761247')
INSERT INTO PHONGCHUCNANG
VALUES ('PGD',N'Phòng giám đốc','0989761249')

---Thêm dữ liệu bảng chức vụ
INSERT INTO CHUCVU
VALUES ('GD',N'Giám đốc')
INSERT INTO CHUCVU
VALUES ('PHGD',N'Phó giám đốc')
INSERT INTO CHUCVU
VALUES ('TK',N'Trưởng khoa')
INSERT INTO CHUCVU
VALUES ('PK',N'Phó khoa')
INSERT INTO CHUCVU
VALUES ('TP',N'Trưởng Phòng')
INSERT INTO CHUCVU
VALUES ('PP',N'Phó phòng')
INSERT INTO CHUCVU
VALUES ('TT',N'Tổ trưởng')
INSERT INTO CHUCVU
VALUES ('YTT',N'Y tá trưởng')
INSERT INTO CHUCVU
VALUES ('BS',N'Bác sĩ')
INSERT INTO CHUCVU
VALUES ('YT',N'Y tá')
INSERT INTO CHUCVU
VALUES ('NV',N'Nhân viên')

---Thêm dữ liệu bảng đối tượng
INSERT INTO DOITUONG
VALUES ('DT0001',N'Bảo hiểm y tế','0.25',N'Có thẻ BHYT')
INSERT INTO DOITUONG
VALUES ('DT0002',N'Dịch vụ','0',N'Không có thẻ BHYT')

---Thêm dữ liệu bảng nhân viên
INSERT INTO NHANVIEN
VALUES ('NV0001','PGD','GD',N'Lê Ngô Tường Vy',N'Nữ','079301016978',N'67 Số 30,Phường 7,Gò Vấp,TP.HCM',Convert(date,'1998/05/05'),'0113112393','nhk@gmail.com','30000000')
INSERT INTO NHANVIEN
VALUES  ('NV0002','PHC','TP',N'Lê Ngô Tường Vân',N'Nữ','052734331206',N'66 Số 21,Phường 14,Gò Vấp,TP.HCM',Convert(date,'1998/06/05'),'0113112387','lntv@gmail.com','18000000')
INSERT INTO NHANVIEN
VALUES ('NV0003','PLTHS','NV',N'Mai Tấn Văn','Nam','071823574269',N'436 Lê Văn Việt,Hiệp Phú,Quận 9,TP.HCM',Convert(date,'1994/07/14'),'0151654323','mtv@gamil.com','10000000')
INSERT INTO NHANVIEN
VALUES ('NV0004','PDD','TP',N'Phạm Thị Tuyết Mai',N'Nữ','074031110854',N'33 Mã Lò,phường Bình Trị Đông A,quận Bình Tân,TP.HCM',Convert(date,'1993/06/26'),'0815131565','pttm@gmail.com','9000000')
INSERT INTO NHANVIEN
VALUES ('NV0005','PKT','TP',N'Phan Đỗ Bảo Nhi',N'Nữ','003773944148',N'219 Nguyễn Thị Định,Phường Bình Trưng Tây,Quận 2,TP.HCM',Convert(date,'1989/09/11'),'0223062393','pdbn@gmail.com','25000000')
INSERT INTO NHANVIEN
VALUES ('NV0006','PKT','PP',N'Phan Thành Nhân', 'Nam','094293671189',N'152 Nguyễn Trọng Tuyển - Tân Bình - HCM',Convert(DateTime,'9/21/1985'), N'0913533233','Ptn@gmail.com','20000000')
INSERT INTO NHANVIEN
VALUES ('NV0007','PKH','TT',N'Phan Ánh Dương', N'Nữ','079252694147',N'65 Nam Kỳ Khởi Nghĩa -q.3 - TP.HCM', Convert(DateTime,'9/28/2001'), N'0981212767','Pad@gmail.com','14000000')
INSERT INTO NHANVIEN
VALUES ('NV0008','PKH','TP',N'Lê Chí Kiên', 'Nam','098852566304', N'564/1/3F Nguyễn Xí - Bình Thạnh - TP.HCM', Convert(DateTime,'3/18/1985'), N'0913162000','Lck@gmail.com','7000000')
INSERT INTO NHANVIEN
VALUES ('NV0009','PDT','NV',N'Đào Thị Hồng', N'Nữ','046125394147', N'764/94 Phạm Văn Chiêu - p.13 - GV - HCM', Convert(DateTime,'6/22/1991'), N'0975432222','Dth@gmail.com','8000000')
INSERT INTO NHANVIEN
VALUES ('NV0010','PGD','PHGD',N'Lê Bạch Tú', N'Nữ','026362895562', N'214 3/2 q10', CONVERT(datetime, '05/09/1994'), N'0358692017','Lbt@gmail.com','9000000')
INSERT INTO NHANVIEN
VALUES ('NV0011','PDD','NV',N'Lưu Hồng Ngọc', N'Nữ','081456786625', N'1 Nguyễn Văn Tráng ,phường Phạm Ngũ Lão, q1', CONVERT(datetime, '12/12/1990'), N'0956123547','Lhn@gmail.com','9000000')
INSERT INTO NHANVIEN
VALUES ('NV0012','PDD','TT',N'Huỳnh Minh Nam', 'Nam','079277194399', N'72/5 Hồng bàng q6', CONVERT(datetime, '12/08/1990'), '0985296314','Hmn@gmail.com','10000000')
INSERT INTO NHANVIEN
VALUES ('NV0013','PKH','PP',N'Trần Thị Thu Ngân', N'Nữ','061785811243', N'288, Nguyến Tri Phương , p4,q10', CONVERT(datetime, '04/08/1991'), '0956245278','Tttn@gmail.com','8000000')
INSERT INTO NHANVIEN
VALUES ('NV0014','PHC','NV',N'Lê Minh Hoàng','Nam','070853404218', N'158 Pasteur q1', CONVERT(datetime, '05/07/2000'),'0912345622','Lmh@gmail.com','8000000')
INSERT INTO NHANVIEN
VALUES ('NV0015','PHC','NV',N'Nguyễn Minh Trang',N'Nữ','096493575240', N'67 Thành Thái,q10', CONVERT(datetime, '05/09/1988'),'0745812369','Nmt@gmail.com','7000000')
INSERT INTO NHANVIEN
VALUES ('NV0016','PLTHS','TP',N'Trần Quyết Thắng','Nam','087302023708', N'50 Cống Quỳnh ,q1', CONVERT(datetime, '05/12/2000'),'098741036','Tqt@gmail.com','6000000')
INSERT INTO NHANVIEN
VALUES ('NV0017','PLTHS','NV',N'Nguyễn Ngọc Ngân',N'Nữ','091486217393', N'67 Vĩnh Viễn q10', CONVERT(datetime, '09/05/1987'),'0852178459','N3n@gmail.com','7000000')
INSERT INTO NHANVIEN
VALUES ('NV0018','PHC','TP',N'Nguyễn Hữu Đông','Nam','069584152701', N'178/97 An Dương Vương Bình Tân', CONVERT(datetime, '09/08/2000'),'0974125874','Nhd@gmail.com','7000000')
INSERT INTO NHANVIEN
VALUES ('NV0019','PDD','NV',N'Trần Minh Trường','Nam','095030474116', N'50 Nguyễn Thị Minh Khai, Q3' , CONVERT(datetime, '05/08/1985'),'0996784512','Tmt@gmail.com','8000000')
INSERT INTO NHANVIEN
VALUES ('NV0020','PLTHS','NV',N'Lê Kim Tiền',N'Nữ','072112893235', N'145 Chấn Hưng, phường 6, quận Tân Bình,TpHCM', CONVERT(datetime, '05/09/1988'),'0745812369','Lkt@gmail.com','8000000')

---Thêm dữ liệu vào bảng bác sĩ
INSERT INTO BACSI
VALUES ('BS0001','KCC','TK',N'Ôn Linh Đan',N'Nữ','0138823451',N'219 Nguyễn Thị Định,Phường Bình Trưng Tây,Quận 2,TP.HCM',Convert(date,'1989/09/11'),'0223062393','20000000')
INSERT INTO BACSI
VALUES ('BS0002','KTK','PK',N'Khương Hoàn Ny',N'Nữ','0606033451',N'67 bis Nguyễn Thượng Hiền, q.Bình Thạnh,Tp.HCM',Convert(date,'1991/02/01'),'0085278993','15000000')
INSERT INTO BACSI
VALUES ('BS0003','KN','BS',N'Từ Vũ',N'Khác','0179451351',N'219 Nguyễn Thị Định,Phường Bình Trưng Tây,Quận 2,TP.HCM',Convert(date,'1997/09/10'),'0939112293','12000000')
INSERT INTO BACSI
VALUES ('BS0004','KCC','TK',N'Lương Công Tiến',N'Nam','0103023419',N'49/12B Nguyễn Thị Minh Khai, Q1, Tp.HCM',Convert(date,'1996/05/11'),'0912313993','21000000')
INSERT INTO BACSI
VALUES ('BS0005','KXN','BS',N'Trần Thị Như Ý',N'Nữ','0146453000',N'123/6 bis Lê Thánh Tôn, Q1, Tp.HCM',Convert(date,'1995/01/21'),'0339317215','10000000')
INSERT INTO BACSI
VALUES ('BS0006','KCC','BS',N'Lý Trân Ngọc',N'Nữ','0100004451',N'178/97 An Dương Vương',Convert(date,'1988/06/13'),'0852785457','14000000')
INSERT INTO BACSI
VALUES ('BS0007','KXN','PK',N'Tô Văn Duy Đang',N'Nam','0138850500',N'78/12/8 Tân Hội',Convert(date,'1984/11/11'),'0981927613','16000000')
INSERT INTO BACSI
VALUES ('BS0008','KCC','BS',N'Đỗ Kiều Duy',N'Nam','0179497171',N'Lô C, phòng 28, chung cư Thanh Đa',Convert(date,'1993/09/02'),'0109021213','13500000')
INSERT INTO BACSI
VALUES ('BS0009','KPS','TK',N'Trần Thủy Tiên',N'Nữ','0503213451',N'67 Kỳ Đồng',Convert(date,'1989/11/06'),'0339852705','20000000')
INSERT INTO BACSI
VALUES ('BS0010','KCX','TK',N'Trần Ý Vy',N'Nữ','0938000451',N'51 Cao Thắng,Phường 3,Quận 3,TP.HCM',Convert(date,'1994/12/01'),'0339317215','19000000')
INSERT INTO BACSI
VALUES ('BS0011','KDL','PK',N'Trần Vũ Minh',N'Nam','0938000434',N'49 Nguyễn Thị Minh Khai, Q1, Tp.HCM',CONVERT(datetime, '09/05/1987'),'0339317217','15500000')
INSERT INTO BACSI
VALUES ('BS0012','KTM','BS',N'Lê Quốc Đạt',N'Nam','0938000445',N'256 Nguyễn Tri Phương , Q10, TpHCM',CONVERT(datetime, '08/02/1987'),'0339317223','12000000')
INSERT INTO BACSI
VALUES ('BS0013','KYHCT','BS',N'Nguyễn Thị Cẩm Hương',N'Nữ','0938210445',N'1235 Hoàng Sa, quận Tân Bình, Tp.HCM',CONVERT(datetime, '03/12/1987'),'0339317219','11500000')
INSERT INTO BACSI
VALUES ('BS0014','KTIM','TK',N'Trần Gia Minh',N'Nam','0968210445',N'170 Hoàng Diệu, phường 9, quận 4, Tp.HCM',CONVERT(datetime, '08/12/1987'),'0872782366','20000000')
INSERT INTO BACSI
VALUES ('BS0015','KCX','BS',N'Nguyễn Thanh Nguyên',N'Nam','0968230445',N'48 Đường số 1, Phường 7, Gò Vấp, Tp.HCM',CONVERT(datetime, '08/08/1987'),'0913322468','10500000')
INSERT INTO BACSI
VALUES ('BS0016','KPS','BS',N'Phan Thanh Tâm',N'Nữ','0928230465',N'123A NGUYỄN KIỆM-Q.GÒ VẤP-TP.HCM',CONVERT(datetime, '08/08/1997'),'0338313419','11000000')
INSERT INTO BACSI
VALUES ('BS0017','KDL','BS',N'Võ Cẩm Nhung',N'Nữ','0828230452',N'32/65/9 TRẦN CAO VĂN-PHÚ NHUẬN-TP.HCM',CONVERT(datetime, '04/02/1993'),'0856493318','12000000')
INSERT INTO BACSI
VALUES ('BS0018','KXN','PK',N'Nguyễn Thế Duy',N'Nam','0328230745',N'455 XÔ VIẾT NGHỆ TĨNH',CONVERT(datetime, '04/09/1993'),'0921239795','14500000')
INSERT INTO BACSI
VALUES ('BS0019','KXN','BS',N'Lê Văn Thịnh',N'Nam','0289230415',N'41 XÓM CỦI',CONVERT(datetime, '07/09/1993'),'0874649876','13000000')
INSERT INTO BACSI
VALUES ('BS0020','KTIM','BS',N'Lê Văn Khương',N'Nam','0568263055',N'1110 PHAN VĂN TRỊ',CONVERT(datetime, '05/09/1993'),'0972448166','14000000')
INSERT INTO BACSI
VALUES ('BS0021','KYHCT','TK',N'Phạm Hoài Thanh',N'Nữ','0928230786',N'123A Nguyễn Tri Phương-q5-TP.HCM',CONVERT(datetime, '08/09/1998'),'0338327211','19500000')
INSERT INTO BACSI
VALUES ('BS0022','KDL','TK',N'Vương Gia Huệ',N'Nữ','0828231348',N'32/65 Phan Xích Long-Phú Nhuận-TP.HCM',CONVERT(datetime, '04/12/1993'),'0336327793','19000000')
INSERT INTO BACSI
VALUES ('BS0023','KYHCT','BS',N'Nguyễn Đức Trí',N'Nam','0328230257',N'455 Đồng Khởi',CONVERT(datetime, '04/09/1995'),'0356327520','10000000')
INSERT INTO BACSI
VALUES ('BS0024','KN','BS',N'Lý Châu',N'Nam','0282309278',N'41A Nguyễn Thái Học, Q1, TPHCM',CONVERT(datetime, '07/05/1990'),'0246327419','120000000')
INSERT INTO BACSI
VALUES ('BS0025','KTIM','BS',N'Lê Lâm Gia Hân',N'Nữ','0582301369',N'1230 Lê Văn Việt',CONVERT(datetime, '06/09/1989'),'0851397419','14000000')

---Thêm dữ liệu bảng y tá
INSERT INTO YTA
VALUES ('YT0001','KPS','YT',N'Huỳnh Ngọc Yến',N'Nữ','0908823451',N'193 Cô Giang,Quận 1,TP.HCM',Convert(date,'1994/07/14'),'0915712393','7000000')
INSERT INTO YTA
VALUES ('YT0002','KCC','YTT',N'Vũ Hoàng Quyên',N'Nữ','0788123451',N'31A/30 Nguyễn Quý Yêm,quận Bình Tân,TP.HCM',Convert(date,'1994/07/14'),'0915888893','10000000')
INSERT INTO YTA
VALUES ('YT0003','KCC','YT',N'Đinh Minh Thư',N'Nữ','0222319551',N'12H Nguyễn Thị Minh Khai,Đa Kao,Quận 1,TP.HCM',Convert(date,'1996/04/06'),'0981312393','8000000')
INSERT INTO YTA
VALUES ('YT0004','KCC','YT',N'Nguyễn Thị Hoài Thu',N'Nữ','0882345129',N'Lê Lợi,Quận 1,TP.HCM',Convert(date,'1994/07/14'),'0320712214','7500000')
INSERT INTO YTA
VALUES ('YT0005','KPS','YT',N'Lê Hồng Nhung',N'Nữ','0385848463',N'84 Đặng Văn Ngữ,Phường 10,Phú Nhuận,TP.HCM',Convert(date,'1988/09/13'),'0731564393','8000000')
INSERT INTO YTA
VALUES ('YT0006','KXN','YTT',N'Lê Thị Cúc',N'Nữ','0395858473',N'LÔ C, PHÒNG 28, CHUNG CƯ THANH ĐA',Convert(date,'1988/09/13'),'0941552634','9500000')
INSERT INTO YTA
VALUES ('YT0007','KTIM','YTT',N'Mai Minh Mẫn',N'Nam','0395948483',N'78/12/8 TÂN HỘI',Convert(date,'1986/06/12'),'0732721383','10500000')
INSERT INTO YTA
VALUES ('YT0008','KYHCT','YT',N'Nguyễn Thị Minh Ngọc',N'Nữ','0395942793',N'123/6 BIS LÊ THÁNH TÔN, Q1, TPHCM',Convert(date,'1989/08/13'),'0731566790','7000000')
INSERT INTO YTA
VALUES ('YT0009','KDL','YT',N'Phan Lê Thủy Tiên',N'Nữ','0867947463',N'67 BIS NGUYỄN THƯỢNG HIỀN, Q.BÌNH THẠNH, TPHCM',Convert(date,'1990/08/13'),'0831554496','7000000')
INSERT INTO YTA
VALUES ('YT0010','KDL','YTT',N'Bùi Bảo Hân',N'Nữ','0375948293',N'NGÕ 6, PHỐ THANH XUÂN, HÀ NỘI',Convert(date,'1987/05/11'),'0874648899','9500000')
INSERT INTO YTA
VALUES ('YT0011','KDL','YT',N'Nguyễn Thị Hạnh',N'Nữ','0365945522',N'178/97 AN DƯƠNG VƯƠNG',Convert(date,'1994/08/05'),'0952785450','7000000')
INSERT INTO YTA
VALUES ('YT0012','KTM','YT',N'Nguyễn Thị Thu Hồng',N'Nữ','0355799463',N'32/65/9 TRẦN CAO VĂN-PHÚ NHUẬN-TP.HCM',Convert(date,'1995/08/06'),'0842345588','8000000')
INSERT INTO YTA
VALUES ('YT0013','KTM','YT',N'Lâm Bảo Ngọc',N'Khác','0345952569',N'41 Kỳ Đồng, Phường 9, Quận 3, Tp.HCM',Convert(date,'1988/08/02'),'0731635504','7000000')
INSERT INTO YTA
VALUES ('YT0014','KPS','YTT',N'Nguyễn Thị Bích Phượng',N'Nữ','0915942421',N'87A Cửu Long Quận 10, TPHCM',Convert(date,'1986/08/22'),'0912899010','9000000')
INSERT INTO YTA
VALUES ('YT0015','KXN','YT',N'Lý Thị Thái Thương',N'Nữ','0925942418',N'16 Nguyến Đình Chiểu, Phường Đa Kao, Quận 1, TPHCM',Convert(date,'1990/08/24'),'0283925997','7500000')
INSERT INTO YTA
VALUES ('YT0016','KTIM','YT',N'Nguyễn Quỳnh Hương',N'Nữ','0391942463',N'134C Hoàng Hoa Thám, Phường 12, Quận Tân Bình, TPHCM',Convert(date,'1989/08/25'),'0915289914','8000000')
INSERT INTO YTA
VALUES ('YT0017','KCX','YTT',N'Nguyễn Thị Thúy Hảo',N'Nữ','0392945277',N'120 Đường số 7, Bình trị đông B, Quận Bình Tân, HCM',Convert(date,'1988/04/03'),'0845289908','9500000')
INSERT INTO YTA
VALUES ('YT0018','KN','YT',N'Phan Ngọc Hồng Hạnh',N'Nữ','0393962984',N'74 Nguyễn Thị Thập, Him Lam, Quận 7, TPHCM',Convert(date,'1987/08/08'),'0715703322','7000000')
INSERT INTO YTA
VALUES ('YT0019','KPS','YT',N'Hoàng Bảo Kiều Trinh',N'Nữ','0394915171',N'29 Hậu Giang, phường 2, Quận 6, TPHCM',Convert(date,'1993/06/04'),'0282253868','7500000')
INSERT INTO YTA
VALUES ('YT0020','KTIM','YT',N'Trần Hồng Thịnh',N'Nam','0995942119',N'492 Ngô Gia Tự, phường 4, quận 10, TPHCM',Convert(date,'1992/02/04'),'0911620307','8000000')

---Thêm dữ liệu vào bảng nhà cung cấp
INSERT INTO NHACUNGCAP
VALUES (N'NCC001', N'Công ty Bayer AG', N'80 Đồng Khởi, Phường Bến Nghé, Quận 1', N'0872637821',N'bayerag@gmail.com',N'www.bayerAG.com')
INSERT INTO NHACUNGCAP
VALUES (N'NCC002', N'Công ty Swissmdeic', N'587 Nguyễn Kiệm, Phường 9, Quận Phú Nhuận', N'0873268723',N'swissmdeic@gmail.com',N'www.swissmdeic.com')
INSERT INTO NHACUNGCAP
VALUES (N'NCC003', N'Công ty DHG Pharma', N'288 Bis Nguyễn Văn Cừ, An Hòa, Ninh Kiều, TP. Cần Thơ', N'0710389143',N'dhgpharma@dhgpharma.com.vn',N'www.dhgpharma.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC004', N'Công ty cổ phần Traphaco', N'75 Yên Ninh, Ba Đình, Hà Nội', N'0180061612',N'info@traphaco.com.vn',N'www.traphaco.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC005', N'Công ty CP Dược phẩm ImexPharm', N'Số 4, Đường 30/4, Phường 1, TP Cao Lãnh, Đồng Tháp', N'1800555535',N'ImexPharm@gmail.com',N'ImexpharmCorporation.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC006', N'Công ty Cổ phần dược phẩm Hà Tây', N'10A Quang Trung, Hà Đông, Hà Nội', N'0242214368',N'duochatay@gmail.com',N'www.hataphar.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC007', N'Công ty CP Dược phẩm Trung ương Codupha', N'509-515 Tô Hiến Thành, Phường 14, Quận 10, TP.HCM', N'0843865034',N'codupha@codupha.com.vn',N'www.codupha.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC008', N'Công ty CP Y Dược phẩm Vimedimex', N'46-48 Bà Triệu, Hoàn Kiếm, Hà Nội', N'0822475588',N'vietpharm@gmail.com',N'www.vietpharm.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC009', N'Công ty dược Việt Nam', N'12 Ngô Tất Tố - Văn Miếu - Đống Đa - Hà Nội', N'0838443151',N'vinapharm@vinapharm.com.vn',N'www.vinapharm.com.vn')
INSERT INTO NHACUNGCAP
VALUES (N'NCC010', N'Công ty TNHH MTV Dược Sài Gòn', N'18 - 20 Nguyễn Trường Tộ, Phường 13, Quận 4, Tp.HCM', N'0287109879',N'contact@sapharco.com',N'www.sapharco.com')

---Thêm dữ liệu vào bảng hồ sơ thuốc
INSERT INTO HOSOTHUOC
VALUES ('HST001', N'NCC007', N'Thuốc kháng nguyên HBsAg', Convert(date,'2022/01/04'),Convert(date,'2024/01/04'),Convert(date,'2022/03/15'),'766',N'Lọ','70774')
INSERT INTO HOSOTHUOC
VALUES ('HST002', N'NCC001', N'Ceftazidime Gerda 2g', Convert(date,'2022/01/19'),Convert(date,'2023/12/19'),Convert(date,'2022/02/16'),'905',N'Lọ','120000')
INSERT INTO HOSOTHUOC
VALUES ('HST003', N'NCC008', N'New Ameflu PM', Convert(date,'2022/03/01'),Convert(date,'2025/03/01'),Convert(date,'2022/03/15'),'3250',N'Viên','2000')
INSERT INTO HOSOTHUOC
VALUES ('HST004', N'NCC006', N'Zinnat Suspension', Convert(date,'2021/12/30'),Convert(date,'2022/12/31'),Convert(date,'2022/01/24'),'513',N'Gói','15023')
INSERT INTO HOSOTHUOC
VALUES ('HST005', N'NCC010', N'Diasanté', Convert(date,'2022/01/04'),Convert(date,'2024/01/04'),Convert(date,'2022/03/15'),'1900',N'Viên','2800')
INSERT INTO HOSOTHUOC
VALUES ('HST006', N'NCC009', N'Vitamin B1 100mg', Convert(date,'2022/03/31'),Convert(date,'2024/03/31'),Convert(date,'2022/04/05'),'5300',N'Viên','480')
INSERT INTO HOSOTHUOC
VALUES ('HST007', N'NCC007', N'Deferglob 250', Convert(date,'2022/01/15'),Convert(date,'2023/06/15'),Convert(date,'2022/02/10'),'280',N'Viên','18500')
INSERT INTO HOSOTHUOC
VALUES ('HST008', N'NCC002', N'Atilimus 0,03%', Convert(date,'2021/12/04'),Convert(date,'2024/01/04'),Convert(date,'2022/02/28'),'134',N'Tuýp','239400')
INSERT INTO HOSOTHUOC
VALUES ('HST009', N'NCC003', N'Pavado Cảm cúm', Convert(date,'2022/04/02'),Convert(date,'2024/04/30'),Convert(date,'2022/04/02'),'4100',N'Viên','900')
INSERT INTO HOSOTHUOC
VALUES ('HST010', N'NCC004', N'Aerofor 200 Hfa', Convert(date,'2022/01/10'),Convert(date,'2023/06/10'),Convert(date,'2022/03/10'),'172',N'Ống','187812')
INSERT INTO HOSOTHUOC
VALUES ('HST011', N'NCC005', N'Thuốc bột pha tiêm Tabaxin', Convert(date,'2021/11/25'),Convert(date,'2022/12/30'),Convert(date,'2021/12/15'),'351',N'Lọ','95000')
INSERT INTO HOSOTHUOC
VALUES ('HST012', N'NCC009', N'Simegaz Plus', Convert(date,'2022/01/23'),Convert(date,'2023/01/23'),Convert(date,'2022/03/06'),'2000',N'Gói','3900')
INSERT INTO HOSOTHUOC
VALUES ('HST013', N'NCC010', N'Thuốc cốm Molnia', Convert(date,'2022/02/17'),Convert(date,'2023/08/17'),Convert(date,'2022/02/25'),'4000',N'Gói','50100')
INSERT INTO HOSOTHUOC
VALUES ('HST014', N'NCC008', N'Sirô Lycalci', Convert(date,'2022/01/04'),Convert(date,'2024/01/04'),Convert(date,'2022/03/15'),'269',N'Ống','11000')
INSERT INTO HOSOTHUOC
VALUES ('HST015', N'NCC001', N'ZT-Amox', Convert(date,'2021/10/10'),Convert(date,'2024/04/10'),Convert(date,'2021/12/06'),'595',N'Lọ','83925')
INSERT INTO HOSOTHUOC
VALUES ('HST016', N'NCC006', N'Thuốc kẽm Grazincure', Convert(date,'2022/01/04'),Convert(date,'2024/01/04'),Convert(date,'2022/03/15'),'677',N'Chai','30000')
INSERT INTO HOSOTHUOC
VALUES ('HST017', N'NCC001', N'Thuốc trị bỏng Trancumin-OPC', Convert(date,'2022/01/30'),Convert(date,'2024/07/30'),Convert(date,'2022/03/27'),'229',N'Tuýp','17877')
INSERT INTO HOSOTHUOC
VALUES ('HST018', N'NCC007', N'Thuốc trị đau răng Dentanalgi', Convert(date,'2022/02/14'),Convert(date,'2023/02/14'),Convert(date,'2022/02/14'),'321',N'Chai','20055')
INSERT INTO HOSOTHUOC
VALUES ('HST019', N'NCC010', N'Maxposide', Convert(date,'2022/01/11'),Convert(date,'2024/01/11'),Convert(date,'2022/01/20'),'555',N'Lọ','19900')
INSERT INTO HOSOTHUOC
VALUES ('HST020', N'NCC009', N'Giáng chỉ đường an', Convert(date,'2022/03/24'),Convert(date,'2023/09/24'),Convert(date,'2022/04/15'),'5400',N'Viên','1950')

---Thêm dữ liệu vào bảng hồ sơ bệnh án
INSERT INTO HOSOBENHAN
VALUES ('HS0025','BN0025','KCX',NULL,N'Ghép xương nhân tạo',N'Sốc nhẹ',N'Cần theo dõi thêm')
INSERT INTO HOSOBENHAN
VALUES ('HS0001','BN0001','KTIM','TS0001',N'Điều phối thuốc, bơm máu',NULL,N'Nhập viện theo dõi')
INSERT INTO HOSOBENHAN
VALUES ('HS0002','BN0002','KYHCT','TS0002',N'Xét nghiệm máu chẩn bệnh',NULL,N'Uống thuốc Đông y')
INSERT INTO HOSOBENHAN
VALUES ('HS0024','BN0024','KYHCT',NULL,N'Trị liệu theo pp cổ truyền',N'Chấn động não nhẹ',N'Trị liệu thích hợp')
INSERT INTO HOSOBENHAN
VALUES ('HS0003','BN0003','KTK','TS0003',N'Xét nghiệm chẩn bệnh',NULL,N'Trị liệu thích hợp')
INSERT INTO HOSOBENHAN
VALUES ('HS0023','BN0023','KCC',NULL,N'Mổ khẩn cấp',N'Sốc nhiệt',N'Ưu tiên theo dõi')
INSERT INTO HOSOBENHAN
VALUES ('HS0004','BN0004','KCX','TS0004',N'Trị liệu giảm đau',NULL,N'Có xu hướng giảm bớt')
INSERT INTO HOSOBENHAN
VALUES ('HS0005','BN0005','KTK','TS0005',N'Xét nghiệm chẩn bệnh',NULL,N'Theo dõi cẩn thận')
INSERT INTO HOSOBENHAN
VALUES ('HS0006','BN0006','KTK','TS0006',N'Xét nghiệm chẩn bệnh',N'Ngất xỉu',N'Theo dõi cẩn thận')
INSERT INTO HOSOBENHAN
VALUES ('HS0022','BN0022','KXN',NULL,N'Xét nghiệm định kỳ',NULL,N'Cơ thể bình thường')
INSERT INTO HOSOBENHAN
VALUES ('HS0021','BN0021','KRHM',NULL,N'Nhổ răng khôn bằng công nghệ cao',NULL,N'Kết quả tốt')
INSERT INTO HOSOBENHAN
VALUES ('HS0020','BN0020','KTIM',NULL,N'Uống thuốc bổ máu',NULL,N'Phản ứng tốt')
INSERT INTO HOSOBENHAN
VALUES ('HS0007','BN0007','KPS','TS0007',N'Đẻ mổ',N'Băng huyết',N'Đề nghị điều trị thích hợp')
INSERT INTO HOSOBENHAN
VALUES ('HS0008','BN0008','KYHCT','TS0008',N'Uống thuốc Đông y',NULL,N'Giảm ho')
INSERT INTO HOSOBENHAN
VALUES ('HS0009','BN0009','KCX','TS0009',N'Xét nghiệm chẩn bệnh',NULL,N'Chưa giảm bớt')
INSERT INTO HOSOBENHAN
VALUES ('HS0010','BN0010','KTK','TS0010',N'Nhập viện theo dõi',NULL,N'Giảm bớt')
INSERT INTO HOSOBENHAN
VALUES ('HS0019','BN0019','KCC',NULL,N'Mổ gấp',NULL,N'Ca mổ thành công')
INSERT INTO HOSOBENHAN
VALUES ('HS0011','BN0011','KXN','TS0011',N'Xét nghiệm định kỳ',NULL,N'Cơ thể bình thường')
INSERT INTO HOSOBENHAN
VALUES ('HS0018','BN0018','KTIM',NULL,N'Hồi máu cơ tim',NULL,N'Có xu hướng giảm')
INSERT INTO HOSOBENHAN
VALUES ('HS0012','BN0012','KTM','TS0012',N'Thoa thuốc thích hợp',N'Nổi mụn trứng cá',N'Có xu hướng giảm')
INSERT INTO HOSOBENHAN
VALUES ('HS0013','BN0013','KYHCT','TS0013',N'Uống thuốc Tây',NULL,N'Có xu hướng giảm')
INSERT INTO HOSOBENHAN
VALUES ('HS0017','BN0017','KCC',NULL,N'Mổ gấp',NULL,N'Thành công')
INSERT INTO HOSOBENHAN
VALUES ('HS0015','BN0014','KXN','TS0014',N'Siêu âm chẩn đoán',NULL,N'Đau bao tử')
INSERT INTO HOSOBENHAN
VALUES ('HS0016','BN0016','KDL',NULL,N'Thoa thuốc kháng sinh',NULL,N'Giảm bớt')

---Thêm dữ liệu vào bảng bệnh nhân
INSERT INTO BENHNHAN
VALUES ('BN0001','DT0001',N'Lê Hoàng Dương',N'Nam','097301012389',N'183/29G Tân Hoà Đông,Phường 14,Quận 6,TP.HCM',Convert(date,'1989/03/04'),'0339852705',N'Lhd@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0002','DT0001',N'Trần Xuân Hiên',N'Nữ','097301012727',N'99A Trần Văn Đang,P.9,Quận 3,TP.HCM',Convert(date,'1999/02/16'),'0827393993',N'Txh@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0003','DT0001',N'Lê Nhật Tường',N'Nam','097301012419',N'145 Nguyễn Gia Trí,Phường 25,Quận Bình Thạnh,,TP.HCM',Convert(date,'1997/01/05'),'0339317215',N'Lnt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0004','DT0001',N'Vũ Minh Trí',N'Nam','097301012635',N'C218 Xóm Chiếu,Quận 4,TP.HCM',Convert(date,'1989/12/10'),'0903393993',N'Vmt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0005','DT0002',N'Vũ Thu Phương',N'Nữ','097301012511',N'243/29E Tôn Đản,P.15,Quận 4,TP.HCM',Convert(date,'1999/06/20'),'0852785457',N'Vtp@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0006','DT0001',N'Đoàn Kim Anh',N'Nữ','097301012433',N'150 Lê Văn Sỷ,Phường 10,Phú Nhuận,TP.HCM',Convert(date,'1999/10/03'),'0939393993',N'Dka@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0007','DT0001',N'Quách Xuân Linh',N'Nữ','097301012716',N'223 Trần Bình Trọng,Quận 5,TP.HCM',Convert(date,'1996/05/09'),'0930339373',N'Qxl@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0008','DT0001',N'Trần Tùng Duy',N'Nam','097301012308',N'346 Lê Văn Sỹ,Phường 2,Quận Tân Bình,TP.HCM',Convert(date,'2000/12/27'),'0852785457',N'Ttd@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0009','DT0001',N'Hồ Phương Anh',N'Nữ','097301012827',N'Hẻm 386/43B Lê Văn Sỹ,Phường 14,Quận 3,TP.HCM',Convert(date,'1998/08/04'),'0085278993',N'HPA@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0010','DT0002',N'Mai Phương Anh',N'Nữ','097301012111',N'147 đường số 9,Phước Bình,Quận 9,TP.HCM',Convert(date,'1997/04/06'),'0339317831',N'Mpa@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0011','DT0002',N'Phan Bá Tú','Nam','097301012533',N'số 75, đường số 18, phường 8, Gò Vấp, TPHCM',Convert(date,'1997/04/06'),'0339319922',N'Pbt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0012','DT0001',N'Lê Minh Trường','Nam','097301012970',N'20/36 Hồ Đắc Di, quận Tân Phú, TPHCM',Convert(date,'1997/04/06'),'0339310211',N'LMT@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0013','DT0002',N'Nguyễn Thị Thùy Linh',N'Nữ','097301012843',N'250 Nguyễn Thái Bình, P12, Tân Bình',Convert(date,'1997/04/06'),'0939317444',N'Nttl@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0014','DT0001',N'Phạm Đăng Minh Nhật','Nam','097301012226',N'250 Nguyễn Thái Bình, Phường 12, Quận Tân Bình',Convert(date,'1997/04/06'),'0859317206',N'Pdmn@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0015','DT0001',N'Phan Văn Phú','Nam','097301012401',N'Tân Định, quận 1, TPHCM',Convert(date,'1997/04/06'),'0339317215',N'Pvp@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0016','DT0002',N'Trần Thị Thu Hằng',N'Nữ','097301012516',N'hẻm 166 Lý Thái Tổ, phường 1, quận 3, TPHCM',Convert(date,'1997/04/06'),'0789317475',N'TTTH@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0017','DT0002',N'Trần Lê Thủy Tiên',N'Nữ','097301012616',N'718 Nguyễn Đình Chiểu, phường 1, quận 3, TPHCM',Convert(date,'1997/04/06'),'0939317436',N'Tltt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0018','DT0001',N'Nguyễn Đức Tài','Nam','097301012507',N'40 Hồng Bàng, phường 1, quận Bình Thạnh, TPHCM',Convert(date,'1997/04/06'),'0859317433',N'Pttt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0019','DT0001',N'Nguyễn Đình Lâm Bích',N'Nữ','097301012933',N'25 Cô Bắc, Cầu Ông Lãnh, quận 1, TPHCM',Convert(date,'1997/04/06'),'0939317707',N'Ndt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0020','DT0001',N'Trần Phan Hồng Ngọc',N'Nữ','097301012252',N'52 Mạc Đĩnh Chi, phường Đa Kao, quận 1, TPHCM',Convert(date,'1997/04/06'),'0939317687',N'TPHN@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0021','DT0002',N'Mai Thu Trang',N'Nữ','097301012437',N'17A Ngô Văn Năm, Bến Nghé, quận 1, TPHCM',Convert(date,'1997/04/06'),'0339317214',N'MTT@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0022','DT0001',N'Phạm Trần Thanh Thảo',N'Nữ','097301012257',N'27 Trần Quốc Thảo, phường 6, quận 3, TPHCM',Convert(date,'1997/04/06'),'0539317776',N'Pttt@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0023','DT0001',N'Đặng Thị Bích Loan',N'Nữ','097301012101',N'23 Tôn Đức Thắng, Bến Nghé, quận 1, TPHCM',Convert(date,'1997/04/06'),'0939317223',N'Dtbl@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0024','DT0002',N'Lương Trung Hoàng','Nam','097301019606',N'376 Võ Văn Kiệt, Cô Giang, quận 1, TPHCM',Convert(date,'1997/04/06'),'0839317246',N'Lth@gmail.com')
INSERT INTO BENHNHAN
VALUES ('BN0025','DT0002',N'Phương Minh','Nam','097301013548',N'44 Hoa Hồng, Phường 2, Quận Phú Nhuận',Convert(date,'2000/10/09'),'0339317547',N'Pminh@gmail.com')

---Thêm dữ liệu vào bảng phiếu điều trị
INSERT INTO PHIEUDIEUTRI
VALUES('TS0001','BN0001',Convert(date,'2021/04/01'),N'Sức khỏe yếu, không làm được việc nặng',N'Có vấn đề Tim, Phải nhập viện')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0002','BN0002',Convert(date,'2021/04/01'),N'Ho nhiều',N'Có vấn đề Phổi, Phải xét nghiệm')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0003','BN0003',Convert(date,'2022/03/02'),N'Thường xuyên đau đầu',N'Có vấn đề hệ Thần Kinh, Phải xét nghiệm')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0004','BN0004',Convert(date,'2021/10/28'),N'Đau cột sống',N'Có vấn đề Xương Khớp, Phải xét nghiệm')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0005','BN0005',Convert(date,'2021/12/15'),N'Thường xuyên chóng mặt',N'Có vấn đề hệ Thần Kinh, Phải xét nghiệm')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0006','BN0006',Convert(date,'2022/02/02'),N'Thường xuyên đau đầu',N'Có vấn đề hệ Thần Kinh, Phải xét nghiệm')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0007','BN0007',Convert(date,'2022/04/02'),N'Sinh con',N'Phải nhập viện')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0008','BN0008',Convert(date,'2021/12/30'),N'Ho nhiều, sức khỏe suy nhược',N'Có vấn đề Phổi, Phải nhập viện')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0009','BN0009',Convert(date,'2022/03/06'),N'Đau xương khớp nặng, không thể đi lại',N'Có vấn đề Xương Khớp, Phải nhập viện')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0010','BN0010',Convert(date,'2022/01/31'),N'Chóng mặt, đau đầu nặng',N'Có vấn đề hệ Thần Kinh, Phải nhập viện')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0011','BN0011',Convert(date,'2021/11/18'),N'Xét nghiệm máu',N'Thiếu máu')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0012','BN0012',Convert(date,'2022/04/03'),N'Phẩu thuật thẩm mĩ nâng càm, độn má',N'Phải nhập viện')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0013','BN0013',Convert(date,'2022/04/03'),N'Ho nhiều',N'Phải xét nghiệm, Nhận thuốc')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0014','BN0014',Convert(date,'2022/04/02'),N'Đau bụng dai dẳng',N'Phải siêu âm')
INSERT INTO PHIEUDIEUTRI
VALUES('TS0015','BN0015',Convert(date,'2022/04/02'),N'Bị ngất xỉu thường xuyên',N'Phải xét nghiệm')

---Thêm dữ liệu bảng toa thuốc
INSERT INTO TOATHUOC
VALUES('TS0001','BN0001','BS0001','HST002','14',N'2 lần/ngày')
INSERT INTO TOATHUOC							   
VALUES('TS0001','BN0001','BS0001','HST015','20',N'1 lần/ngày')
INSERT INTO TOATHUOC				 	    
VALUES('TS0001','BN0001','BS0001','HST001','7',N'1 lần/ngày')
INSERT INTO TOATHUOC				 	    
VALUES('TS0002','BN0002','BS0021','HST008','21',N'3 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0002','BN0002','BS0021','HST009','14',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0003','BN0008','BS0002','HST010','14',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0003','BN0008','BS0002','HST004','7',N'1 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0003','BN0008','BS0002','HST005','21',N'3 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0004','BN0003','BS0005','HST007','28',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0005','BN0004','BS0015','HST019','10',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0013','BN0005','BS0016','HST020','7',N'1 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0006','BN0010','BS0001','HST020','14',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0007','BN0011','BS0002','HST019','21',N'3 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0006','BN0010','BS0001','HST001','28',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0006','BN0010','BS0001','HST011','10',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0007','BN0011','BS0007','HST006','7',N'1 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0008','BN0007','BS0009','HST018','14',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0008','BN0007','BS0009','HST015','21',N'3 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0009','BN0005','BS0025','HST003','28',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0010','BN0012','BS0012','HST020','20',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0014','BN0013','BS0013','HST019','10',N'1 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0011','BN0009','BS0010','HST018','21',N'3 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0012','BN0013','BS0011','HST002','14',N'2 lần/ngày')
INSERT INTO TOATHUOC			 	    
VALUES('TS0012','BN0006','BS0002','HST008','14',N'2 lần/ngày')


---Thêm dữ liệu bảng hóa đơn viện phí
INSERT INTO HOADONVIENPHI
VALUES  ('HD0001', 'BN0001', 'NV0002', Convert(date,'2022/04/01'), Convert(date,'2022/04/01'), N'Chuyển khoản','7999200'),
		('HD0002', 'BN0002', 'NV0002', Convert(date,'2022/04/01'), Convert(date,'2022/04/01'), N'Tiền mặt','599000'),
		('HD0003', 'BN0008', 'NV0005', Convert(date,'2022/03/02'), Convert(date,'2022/03/03'), N'Tiền mặt','799000'),
		('HD0004', 'BN0003', 'NV0005', Convert(date,'2021/10/28'), Convert(date,'2021/10/30'), N'Tiền mặt','790000'),
		('HD0005', 'BN0004', 'NV0006', Convert(date,'2021/12/15'), Convert(date,'2021/12/15'), N'Chuyển khoản','599000'),
		('HD0006', 'BN0010', 'NV0006', Convert(date,'2022/02/02'), Convert(date,'2022/02/03'), N'Chuyển khoản','899000'),
		('HD0007', 'BN0011', 'NV0014', Convert(date,'2022/04/02'), Convert(date,'2022/04/02'), N'Tiền mặt','6299100'),
		('HD0008', 'BN0007', 'NV0014', Convert(date,'2021/12/30'), Convert(date,'2021/12/31'), N'Chuyển khoản','7999000'),
		('HD0009', 'BN0005', 'NV0015', Convert(date,'2022/03/06'), Convert(date,'2022/03/06'), N'Chuyển khoản','7199100'),
		('HD0010', 'BN0012', 'NV0015', Convert(date,'2022/01/31'), Convert(date,'2022/02/01'), N'Chuyển khoản','2699100'),
		('HD0011', 'BN0009', 'NV0018', Convert(date,'2021/11/18'), Convert(date,'2021/11/18'), N'Tiền mặt','2699100'),
		('HD0012', 'BN0006', 'NV0018', Convert(date,'2022/04/03'), Convert(date,'2022/04/04'), N'Chuyển khoản','2699100'),
		('HD0013', 'BN0013', 'NV0002', Convert(date,'2022/04/03'), Convert(date,'2022/04/03'), N'Chuyển khoản','2699100'),
		('HD0014', 'BN0014', 'NV0005', Convert(date,'2022/04/02'), Convert(date,'2022/04/04'), N'Chuyển khoản','2699100'),
		('HD0015', 'BN0015', 'NV0006', Convert(date,'2022/04/02'), Convert(date,'2022/04/02'), N'Chuyển khoản','2699100')

---Thêm dữ liệu bảng chi tiết hóa đơn viện phí
INSERT INTO CHITIETHOADON
VALUES ('HD0001','HST002','1','125000')
INSERT INTO CHITIETHOADON
VALUES ('HD0001','HST015','1','85000')
INSERT INTO CHITIETHOADON
VALUES ('HD0001','HST001','1','75000')
INSERT INTO CHITIETHOADON
VALUES ('HD0002','HST008','1','243000')
INSERT INTO CHITIETHOADON
VALUES ('HD0002','HST009','14','125000')
INSERT INTO CHITIETHOADON
VALUES ('HD0003','HST010','14','125000')
INSERT INTO CHITIETHOADON
VALUES ('HD0003','HST004','7','20000')
INSERT INTO CHITIETHOADON
VALUES ('HD0003','HST005','21','2500')
INSERT INTO CHITIETHOADON
VALUES ('HD0004','HST007','28','750')
INSERT INTO CHITIETHOADON
VALUES ('HD0005','HST019','1','25000')
INSERT INTO CHITIETHOADON
VALUES ('HD0005','HST016','1','35000')
INSERT INTO CHITIETHOADON
VALUES ('HD0006','HST002','1','125000')
INSERT INTO CHITIETHOADON
VALUES ('HD0006','HST005','14','3500')
INSERT INTO CHITIETHOADON
VALUES ('HD0006','HST001','1','75000')
INSERT INTO CHITIETHOADON
VALUES ('HD0006','HST011','1','100000')
INSERT INTO CHITIETHOADON
VALUES ('HD0007','HST006','7','1000')
INSERT INTO CHITIETHOADON
VALUES ('HD0008','HST008','1','243000')
INSERT INTO CHITIETHOADON
VALUES ('HD0008','HST015','1','87000')
INSERT INTO CHITIETHOADON
VALUES ('HD0009','HST003','28','3000')
INSERT INTO CHITIETHOADON
VALUES ('HD0010','HST020','20','3000')
INSERT INTO CHITIETHOADON
VALUES ('HD0010','HST012','10','4500')
INSERT INTO CHITIETHOADON
VALUES ('HD0011','HST014','21','15000')
INSERT INTO CHITIETHOADON
VALUES ('HD0011','HST001','1','75000')
INSERT INTO CHITIETHOADON
VALUES ('HD0012','HST008','1','245000')

---Thêm dữ liệu bảng báo cáo
INSERT INTO BAOCAO
VALUES ('BC0001','NV0003',N'Báo cáo doanh thu tháng 3/2022',Convert(date,'2022/04/01'),N'Xem xét kĩ')
INSERT INTO BAOCAO
VALUES ('BC0002','NV0019',N'Báo cáo tình trạng bệnh nhân',Convert(date,'2022/04/02'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0003','NV0002',N'Báo cáo kết quả thu chi quý 1/2022',Convert(date,'2022/04/02'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0004','NV0020',N'Báo cáo lưu trữ hồ sơ tồn đọng',Convert(date,'2022/04/02'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0005','NV0013',N'Báo cáo chỉ tiêu tháng 3/2022',Convert(date,'2022/04/01'),N'Xem xét kĩ')
INSERT INTO BAOCAO
VALUES ('BC0006','NV0004',N'Báo cáo số lượng thuốc quý 1',Convert(date,'2022/04/02'),N'Cần lưu ý')
INSERT INTO BAOCAO
VALUES ('BC0007','NV0005',N'Báo cáo doanh thu ngoại viện tháng 3/2022',Convert(date,'2022/04/01'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0008','NV0005',N'Báo cáo doanh thu nội viện tháng 3/2022',Convert(date,'2022/04/01'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0009','NV0003',N'Báo cáo về việc giải quyết hồ sơ',Convert(date,'2022/04/02'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0010','NV0020',N'Báo cáo tình hình lưu trữ',Convert(date,'2022/04/02'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0011','NV0005',N'Báo cáo tài chính',Convert(date,'2022/04/02'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0012','NV0005',N'Báo cáo về ảnh hưởng thời tiết lên CSHT',Convert(date,'2022/04/02'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0013','NV0019',N'Báo cáo tình hình xuất nhập thuốc',Convert(date,'2022/04/02'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0014','NV0020',N'Báo cáo tình hình đầu tư tháng 3',Convert(date,'2022/04/02'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0015','NV0005',N'Báo cáo tình hình đầu tư tháng 2',Convert(date,'2022/03/02'),N'Xem xét kĩ')
INSERT INTO BAOCAO
VALUES ('BC0016','NV0003',N'Báo cáo lưu lượng bệnh nhân',Convert(date,'2022/04/02'),NULL)
INSERT INTO BAOCAO
VALUES ('BC0017','NV0020',N'Báo cáo tình hình lưu trữ',Convert(date,'2022/04/10'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0018','NV0005',N'Báo cáo tình trạng chuyển đổi năm 2021',Convert(date,'2022/01/10'),N'Xem xét kĩ')
INSERT INTO BAOCAO
VALUES ('BC0019','NV0005',N'Báo cáo quý 1/2022',Convert(date,'2022/04/02'),N'Cần duyệt gấp')
INSERT INTO BAOCAO
VALUES ('BC0020','NV0003',N'Báo cáo tình hình lưu trữ',Convert(date,'2022/04/02'),N'Cần duyệt gấp')

---4.1. Synonym (tạo tên đồng nghĩa)
---4.1.1.Tạo tên đồng nghĩa BN truy xuất vào BENHNHAN 
Create Synonym BN for BENHNHAN
---Truy xuất dữ liệu
SELECT * 
FROM BN

---4.1.2.Tạo tên đồng nghĩa NV truy xuất vào NHANVIEN do người dùng làm chủ sở hữu
Create Synonym NV for dbo.NHANVIEN
---Truy xuất dữ liệu
SELECT *
FROM NV

---4.1.3.Tạo tên đồng nghĩa BS truy xuất vào BACSI 
Create Synonym BS for BACSI
---Truy xuất dữ liệu
SELECT *
FROM BS

---4.2.INDEX( chỉ mục)
---4.2.1.Tạo chỉ mục trên thuộc tính mã bệnh nhân của bảng BENHNHAN.
CREATE TABLE BENHNHANN
(
	MABN		NVARCHAR (6),
	HOTENBN     NVARCHAR(100),
	CMNDBN        NVARCHAR(12),	
	GIOITINHBN	NVARCHAR (10) CONSTRAINT CK_GIOITINHBN_BENHNHANN CHECK (GIOITINHBN IN (N'Nam', N'Nữ', N'Khác')),
	NGAYSINHBN	DATETIME ,
	DIACHIBN		NVARCHAR(100) ,
	SDTBN		NVARCHAR(15),
	EMAILBN NVARCHAR(50)	
)
---Thực thi 
CREATE Clustered INDEX index_MABN ON BENHNHANN(MABN)
---Xem thông tin INDEX
EXEC sp_helpindex 'BENHNHANN';

---4.2.2.Tạo chỉ mục trên thuộc tính họ tên bác sĩ của bảng bác sĩ
CREATE TABLE BACSI1
(
MABS NVARCHAR(6),
MAPK NVARCHAR(6),
MACV NVARCHAR(6),
HOTENBS NVARCHAR(100),
CMNDBS NVARCHAR(12),
DIACHIBS NVARCHAR(100),
NGAYSINHBS DATETIME,
SDTBS NVARCHAR(11)
)
---Thực thi
CREATE Nonclustered INDEX index_HOTENBS ON BACSI1(HOTENBS)
---Xem thông tin INDEX
EXEC sp_helpindex 'BACSI1';

---4.2.3.Tạo chỉ mục trên thuộc tính chứng minh nhân dân của bảng y tá
CREATE TABLE YTA1
(
MAYT NVARCHAR(6),
MAPK NVARCHAR(6),
MACV NVARCHAR(6),
HOTENYT NVARCHAR(100),
CMNDYT NVARCHAR(12),
DIACHIYT NVARCHAR(100),
NGAYSINHYT DATETIME,
SDTYT NVARCHAR(15)
)
---Thực thi
CREATE Unique INDEX index_CMNDYT ON YTA1(CMNDYT)
---Xem thông tin INDEX
EXEC sp_helpindex 'YTA1';

---4.3.VIEW(Khung nhìn)
---4.3.1. Tạo vwDanhSachNhanVienNu với các thông tin gồm: mã nhân viên, họ tên nhân viên, ngày sinh, địa chỉ của các nhân viên nữ
CREATE VIEW vwDanhSachNhanVienNu_Select 
AS
SELECT MANV, HOTENNV, NGAYSINHNV, DIACHINV
FROM NHANVIEN
WHERE GIOITINHNV=N'Nữ'
---Thực thi
SELECT MANV, HOTENNV, NGAYSINHNV, DIACHINV
FROM vwDanhSachNhanVienNu_Select 


---4.3.2. Tạo view bệnh nhân nam  với các thông tin: mã bệnh nhân, họ tên bệnh nhân,tuổi bệnh nhân có độ tuổi từ 21 đến 32 tuổi
CREATE VIEW vwDanhSachBenhNhanNam2_Select 
AS
SELECT MABN,HOTENBN, DATEDIFF( YEAR , NGAYSINHBN,GETDATE()) AS TUOI
FROM BENHNHAN
WHERE GIOITINHBN =N'Nam' AND DATEDIFF( YEAR , NGAYSINHBN,GETDATE()) >=21 AND DATEDIFF(YEAR, NGAYSINHBN,GETDATE())<=32
---Thực thi 
SELECT MABN, HOTENBN, TUOI
FROM vwDanhSachBenhNhanNam2_Select 

---4.3.3.Tạo view vwDsHoaDon2022 với các thông tin: Mã hóa đơn, mã bệnh nhân, họ tên bệnh nhân, họ tên nhân viên của các hóa đơn được lập năm 2022
CREATE VIEW vwDsHoaDon2022_Select
AS
SELECT MAHD, BN.MABN, HOTENBN, HOTENNV
FROM BENHNHAN BN JOIN HOADONVIENPHI HDVP ON BN.MABN = HDVP.MABN JOIN NHANVIEN NV ON HDVP.MANV = NV. MANV
WHERE YEAR(NGAYKHAM)='2022'
---Thực thi
SELECT MAHD, MABN, HOTENBN, HOTENNV
FROM vwDsHoaDon2022_Select

---4.3.4.Tạo view vwThongTinHoaDon với các thông tin: mã hóa đơn, họ tên nhân viên, ngày lấy thuốc, tổng tiền của hóa đơn viện phí (giá bán x số lượng thuốc)
CREATE VIEW vwThôngTinHoaDon_Select
AS
SELECT DISTINCT HD.MAHD, HOTENNV, NGAYLAYTHUOC, DGBAN*SOLUONG AS TONGTIEN
FROM NHANVIEN NV JOIN HOADONVIENPHI HD ON NV.MANV = HD.MANV JOIN CHITIETHOADON CTHD ON HD.MAHD = CTHD.MAHD 
---Thực thi
SELECT MAHD, HOTENNV, NGAYLAYTHUOC, TONGTIEN
FROM vwThôngTinHoaDon_Select

---4.3.5. Tạo view vwThongTinHoadon422 với các thông tin: Mã hóa đơn, mã bệnh nhân, họ tên bệnh nhân, họ tên nhân viên của các hóa đơn tháng 4 năm 2022
CREATE VIEW vwThongTinHoaDon422_Select
AS
SELECT MAHD, BN.MABN, HOTENBN, HOTENNV
FROM BENHNHAN BN JOIN HOADONVIENPHI HD ON BN.MABN = HD.MABN JOIN NHANVIEN NV ON HD.MANV = NV.MANV
WHERE YEAR(NGAYKHAM) = '2022' AND MONTH(NGAYKHAM) = '04'
---Thực thi 
SELECT MAHD, MABN, HOTENBN, HOTENNV
FROM vwThongTinHoaDon422_Select

---4.3.6. Tạo view vwTriGiaHoaDon02 với các thông tin: Mã hóa đơn, mã bệnh nhân, họ tên bệnh nhân, mã nhân viên,Tổng trị giá hóa đơn (giá bán x số lượng) do một nhân viên lập
CREATE VIEW vwTriGiaHoaDon02_Select 
AS
SELECT   HDVP.MAHD, BN.MABN, HOTENBN, NV.MANV, SUM(DGBAN*SOLUONG) AS TONGTRIGIA
FROM CHITIETHOADON CTHD INNER JOIN HOADONVIENPHI HDVP ON CTHD.MAHD=HDVP.MAHD JOIN BENHNHAN BN ON HDVP.MABN=BN.MABN JOIN NHANVIEN NV ON HDVP.MANV=NV.MANV
WHERE NV.MANV = N'NV0002'
GROUP BY HDVP.MAHD, BN.MABN, NV.MANV, HOTENBN
---Thực thi 
SELECT MAHD, MABN, MANV, HOTENBN, TONGTRIGIA
FROM vwTriGiaHoaDon02_Select 

---4.4. FUNCTION
---4.4.1 Viết hàm cho biết số lượng bệnh nhân chữa trị ở các khoa với tham số truyền vào là mã khoa
CREATE FUNCTION F_SOLUONGBENHNHANTRONGKHOA(@MAKHOA NCHAR(6))
RETURNS int 
AS
BEGIN
DECLARE @SOBENHNHAN INT
	SELECT @SOBENHNHAN = COUNT(MAKHOA) 
	FROM HOSOBENHAN
	WHERE MAKHOA = @MAKHOA
	GROUP BY MAKHOA
RETURN @SOBENHNHAN
END
		--Thực thi :
		Print N'Số lượng bệnh nhân ở khoa Cấp Cứu là: '+ Convert(varchar, dbo.F_SOLUONGBENHNHANTRONGKHOA('KCC'))   
		Print N'Số lượng bệnh nhân ở khoa Xét Nghiệm là: '+ Convert(varchar, dbo.F_SOLUONGBENHNHANTRONGKHOA('KXN'))  

--4.4.2.Viết hàm xem danh sách các nhân viên theo mã phòng chức năng (trả về dạng bảng)
CREATE FUNCTION F_DSNhanVienPhong(@MAPH NCHAR(6))
RETURNS Table 
AS
RETURN	
SELECT *
FROM NHANVIEN
WHERE MAPH = @MAPH
GO
		--Thực thi hàm: 
		Select * FROM F_DSNhanVienPhong('PLTHS')
		Select * FROM F_DSNhanVienPhong('PKT')
		Select * FROM F_DSNhanVienPhong('PDD')

---4.4.3.Viết hàm cho biết số lượng hóa đơn viện phí với tham số truyền vào là mã nhân viên
CREATE FUNCTION F_SOLUONGHD(@MANV NCHAR(6))
RETURNS INT
AS
BEGIN
DECLARE @SODH INT
SELECT @SODH= COUNT(MANV) FROM HOADONVIENPHI WHERE MANV=@MANV GROUP BY MANV
RETURN @SODH
END
---thực thi 
PRINT N'SỐ LƯỢNG ĐƠN ĐẶT HÀNG CỦA NHÂN VIÊN MÃ SỐ NV0006 LÀ: '+CONVERT(VARCHAR,dbo.F_SOLUONGHD('NV0006') )

---4.4.4.Viết hàm tính lãi cho từng loại thuốc (giá bán – giá mua)* số lượng đặt cho từng loại thuốc, với mã thuốc là tham số truyền vào.
CREATE FUNCTION F_TINHLAII(@MATHUOC NCHAR(6))
RETURNS int 
AS
BEGIN
DECLARE @TIENLAI INT
	SELECT @TIENLAI = SUM(DGBAN - DGNHAP)*SOLUONG 
	FROM CHITIETHOADON CT, HOSOTHUOC HS
	WHERE HS.MATHUOC = @MATHUOC AND HS.MATHUOC = CT.MATHUOC 
	GROUP BY CT.SOLUONG
RETURN @TIENLAI
END
---Thực thi
Print N'Tiền lãi loại thuốc có mã số HST002 là: '+ Convert(varchar, dbo.F_TINHLAII('HST002'))

---4.4.5.Viết hàm tính lãi cho từng loại thuốc (giá bán – giá mua)* số lượng đặt cho từng loại thuốc
Create Function F_selectTinhLaiLT()
RETURNS Table
AS 
RETURN SELECT HS.MATHUOC, TENTHUOC, SUM(DGBAN - DGNHAP)*SLTHUOC AS TIENLAI
From HOSOTHUOC HS, CHITIETHOADON CT
WHERE HS.MATHUOC = CT.MATHUOC 
GROUP BY HS.MATHUOC, CT.SOLUONG, HS.TENTHUOC, HS.SLTHUOC
---Thực thi
SELECT * FROM dbo.F_selectTinhLaiLT()


---4.5.  STORE PROCEDURE

---4.5.1 Tạo procedure hiển thị danh sách nhân viên tên Ngân
CREATE PROC Proc_DSNhanvien_Ten
AS
BEGIN
	SELECT * FROM NHANVIEN
	WHERE HOTENNV LIKE N'%Ngân'
END
--thực thi Proc--
EXEC Proc_DSNhanvien_Ten

--4.5.2 Tạo procedure hiển thị thông tin bệnh nhân bao gồm: mã bệnh nhân, tên bệnh nhân, mã hồ sơ, khoa bệnh nhân đó từng đến theo mã khoa do người dùng nhập
CREATE PROC Proc_select_KHOA (@MaKhoa NVARCHAR(6))
AS
BEGIN
	SELECT BN.MABN,HOTENBN,MAHS,KHOA.MAKHOA,TENKHOA
	FROM BENHNHAN BN INNER JOIN HOSOBENHAN HSBA ON BN.MABN=HSBA.MABN JOIN KHOA ON HSBA.MAKHOA=KHOA.MAKHOA
	WHERE KHOA.MAKHOA=@MaKhoa
END
--thực thi Proc--
EXEC Proc_select_KHOA 'KCX'

--4.5.3 Cho biết danh sách 10 loại thuốc có số lượng nhiều nhất
CREATE PROC Proc_select_10THUOC
AS
BEGIN
	SELECT TOP(10) * FROM HOSOTHUOC
	ORDER BY SLTHUOC DESC
END
--thực thi Proc--
EXEC Proc_select_10THUOC

--4.5.4 Cho biết tổng trị giá của mỗi hóa đơn
CREATE PROC Proc_select_HD
AS
BEGIN
	SELECT MAHD,SUM(DGBAN*SOLUONG) AS TONGTRIGIA
	FROM CHITIETHOADON
	GROUP BY MAHD
END
---Thực thi
EXEC Proc_select_HD

--4.5.5 Xem thông tin hóa đơn viện phí gồm có: mã hóa đơn, mã nhân viên, họ tên nhân viên, mã bệnh nhân, họ tên bệnh nhân, ngày lấy thuốc với mã số bệnh nhân do người dùng yêu cầu.
CREATE PROC Proc_TTHOADON (@MABN NVARCHAR(6))
as
Begin
	SELECT HD.MAHD,NV.MANV,HOTENNV, BN.MABN, HOTENBN,NGAYLAYTHUOC
	FROM BENHNHAN BN JOIN HOADONVIENPHI HD ON BN.MABN=HD.MABN JOIN NHANVIEN NV ON HD.MANV=NV.MANV
	where BN.MABN=@MABN
End

EXEC Proc_TTHOADON 'BN0003'

--4.5.6 Xem thông tin hồ sơ thuốc gồm mã thuốc, tên thuốc, số lượng nhập, đơn giá bán theo khoảng thời gian từ ngày đến ngày do người dùng yêu cầu.
CREATE PROC Proc_TTHS_KHOANGTG (@Ngaybd datetime2 ,@Ngaykt datetime2)
as
Begin
	SELECT HST.MATHUOC,TENTHUOC,SOLUONG,DGBAN
	FROM HOADONVIENPHI HDVP INNER JOIN CHITIETHOADON CTHD ON HDVP.MAHD=CTHD.MAHD JOIN HOSOTHUOC HST ON CTHD.MATHUOC=HST.MATHUOC
	WHERE @Ngaybd <= NGAYLAYTHUOC AND NGAYLAYTHUOC >= @Ngaykt
End
---Thực thi
EXEC Proc_TTHS_KHOANGTG '2020-12-10','2022-01-15'
EXEC Proc_TTHS_KHOANGTG '2021-12-10','2022-04-01'

--4.5.7 Cho biết các báo cáo được nhân viên của phòng ban nào lập, với mã nhân viên do người dùng nhập 
CREATE PROC Proc_BaocaoNV (@MANV NVARCHAR(6))
AS
BEGIN
	SELECT MABC,TENBC,NGAYLAP,CHUTHICH,HOTENNV,TENPH
	FROM BAOCAO BC INNER JOIN NHANVIEN NV ON BC.MANV=NV.MANV JOIN PHONGCHUCNANG PCN ON NV.MAPH=PCN.MAPH
	WHERE NV.MANV=@MANV
END
---Thực thi
EXEC Proc_BaocaoNV 'NV0005'


--4.5.8 Cho biết tổng chi phí chữa bệnh mỗi ngày (Phí chữa bệnh=Thành tiền-Tổng trị giá thuốc) với ngày lấy thuốc là tham số truyền vào và tổng chi phí khám chữa bệnh là tham số truyền ra
CREATE PROC PHIKHAMBENH(@NgayLt datetime2)
AS
BEGIN
DECLARE @tienkham float
IF exists (SELECT NGAYLAYTHUOC from HOADONVIENPHI WHERE NGAYLAYTHUOC=@NgayLt)
	BEGIN
	SET @tienkham = (SELECT Sum(THANHTIEN-SOLUONG*DGBAN) 
					 FROM CHITIETHOADON CTHD INNER JOIN HOADONVIENPHI HDVP ON CTHD.MAHD=HDVP.MAHD WHERE NGAYLAYTHUOC=@NgayLt GROUP BY NGAYLAYTHUOC)
	PRINT 'Phí khám ngày '+ Cast(@NgayLt as char(11))+N'là: '+ cast(@tienkham as char(30))
	END 
END

EXEC PHIKHAMBENH '2022-04-02'
EXEC PHIKHAMBENH '2021-12-31'

--4.5.9 Lưu trữ các bác sĩ có lương từ 19.000.000 trở lên vào bảng PHUCAP
CREATE PROC Insert_PHUCAP
AS
BEGIN
IF NOT EXISTS (SELECT * FROM SYS.objects WHERE object_id=OBJECT_ID('dbo.PHUCAP'))
BEGIN
CREATE TABLE PHUCAP
(
	MAPC NVARCHAR(6),
	HOTENBS NVARCHAR(100),
	LUONGBS FLOAT
)
END
	INSERT INTO PHUCAP
	SELECT MABS,HOTENBS,LUONGBS
	FROM BACSI
	WHERE LUONGBS>=19000000
END
---Thực thi
EXEC Insert_PHUCAP

--4.5.10 Xem số lượng của một loại thuốc, nếu số lượng >10 thì "Thông báo: Còn thuốc”, ngược lại "Thông báo: Sắp hết thuốc”, với mã thuốc do người dùng nhập*/
Create proc thuoc_SoLuong (@MaThuoc nvarchar(6))
AS
DECLARE @SoLuong int
SELECT @SoLuong = SLTHUOC
FROM HOSOTHUOC
WHERE MATHUOC = @MaThuoc
IF @SoLuong >10
BEGIN
	print N'Số lượng thuốc là: '+cast (@SoLuong as nvarchar(11))
	print N'Thông báo: Còn thuốc.'
END
ELSE
PRINT N'Thông báo: Sắp hết thuốc.'
---Thực thi
EXEC thuoc_SoLuong 'HST005'

--4.5.11 Cho biết thông tin bệnh nhân có thẻ BHYT gồm: MABN, họ tên bệnh nhân, giới tính, ngày sinh, chi phí khám chữa bệnh ban đầu theo MABN do người dùng nhập.
	 --Trong đó: Chi phí khám chữa bệnh ban đầu = THANHTIEN*(1-0.25)  
	 --Trường hợp mã bệnh nhân không thuộc đối tượng có thẻ BHYT, in ra màn hình: "Bệnh nhân không có thẻ BHYT."
CREATE PROC BHYT_BenhNhan_Chiphii (@MaBN nvarchar(6))
AS
BEGIN
	 DECLARE @MaDT nvarchar(6)
	 SELECT @MaDT = DT.MADT
	 FROM DOITUONG DT INNER JOIN BENHNHAN BN ON BN.MADT=DT.MADT JOIN HOADONVIENPHI HDVP ON BN.MABN=HDVP.MABN
	 WHERE BN.MABN = @MaBN
	 IF  @MaDT='DT0001'
		BEGIN
			SELECT BN.MABN, HOTENBN, GIOITINHBN, NGAYSINHBN, THANHTIEN*(1+MIENGIAM) AS N'Chi phí khám chữa bệnh ban đầu'
			FROM DOITUONG DT INNER JOIN BENHNHAN BN ON BN.MADT=DT.MADT JOIN HOADONVIENPHI HDVP ON BN.MABN=HDVP.MABN
			WHERE BN.MABN = @MaBN
		END
	 ELSE
		PRINT N'Bệnh nhân không có thẻ BHYT.'
END

--BỆNH NHÂN CÓ THẺ BHYT
EXEC BHYT_BenhNhan_Chiphii 'BN0001'
--BỆNH NHÂN KHÔNG CÓ THẺ BHYT
EXEC BHYT_BenhNhan_Chiphii 'BN0011'

---4.6.TRIGGER
---4.6.1.Thành Tiền của hóa đơn viện phí phải lớn hơn hoặc bằng 0
CREATE TRIGGER TG_ThanhTien
ON HOADONVIENPHI
FOR INSERT, UPDATE
AS
IF EXISTS (SELECT * FROM INSERTED WHERE INSERTED.THANHTIEN < 0)
BEGIN
PRINT(N'THÀNH TIỀN CỦA HÓA ĐƠN VIỆN PHÍ PHẢI LỚN HƠN HOẶC BẰNG 0')
ROLLBACK TRAN
END
		--INSERT
INSERT INTO HOADONVIENPHI 
VALUES ('HD0027','BN0005','NV0006', Convert(date,'2022/04/01'),Convert(date,'2022/04/01'),N'Chuyển khoản','9999000')
	---UPDATE
	UPDATE HOADONVIENPHI SET THANHTIEN = -2699100 WHERE MAHD ='HD0027'

--4.6.2 Ngày sản xuất thuốc phải nhỏ hơn ngày hết hạn sử dụng của thuốc
CREATE TRIGGER TG_NGAYSX
ON HOSOTHUOC
FOR Insert, Update
AS
IF EXISTS (SELECT * FROM inserted WHERE YEAR(inserted.NGAYSX)>=YEAR(inserted.NGAYHETHAN) 
									AND MONTH(inserted.NGAYSX)>=MONTH(inserted.NGAYHETHAN)
									AND DAY(inserted.NGAYSX)>=DAY(inserted.NGAYHETHAN) )
BEGIN
PRINT(N'Ngày sản xuất thuốc phải nhỏ hơn ngày hết hạn sử dụng của thuốc')
ROLLBACK TRAN
END
---Thực thi
---INSERT (thành công)
INSERT INTO HOSOTHUOC 
VALUES ('HST021', N'NCC010', N'Thuốc giảm đau Panadol', Convert(date,'2022/04/12'),Convert(date,'2023/03/16'),Convert(date,'2022/04/15'),'6300',N'Viên','2300')

---UPDATE (không thành công vì update NGAYSX = NGAYHETHAN => không thực thi được) 
UPDATE HOSOTHUOC SET NGAYSX= '2023-03-16' Where MATHUOC='HST021'

--4.6.3 Tự động cập nhật lại số lượng của một loại thuốc trong bảng HOSOTHUOC khi loại thuốc đó được bán ra 
CREATE TRIGGER TG_CapNhapSLT
ON CHITIETHOADON
FOR Insert
AS
UPDATE HOSOTHUOC
SET SLTHUOC= SLTHUOC-inserted.SOLUONG
FROM HOSOTHUOC INNER JOIN inserted ON HOSOTHUOC.MATHUOC= Inserted.MATHUOC
--INSERT--
INSERT INTO CHITIETHOADON VALUES ('HD0014','HST005',14,3500)

SELECT * FROM HOSOTHUOC
---4.7.USER
---4.7.1. QUẢN LÝ
--Tạo user cho cấp quản lý
CREATE LOGIN QuanLy WITH PASSWORD = '12345', DEFAULT_DATABASE = QUANLYBENHVIEN
CREATE USER QuanLy FOR LOGIN QuanLy

--Cấp quyền
GRANT ALL ON BACSI TO QuanLy
GRANT ALL ON  YTA TO QuanLy
GRANT ALL ON  NHANVIEN TO QuanLy
GRANT ALL ON  TAIKHOAN TO PUBLIC
GRANT ALL ON  BAOCAO TO QuanLy
GRANT ALL ON  HOADONVIENPHI TO QuanLy
GRANT ALL ON  HOSOBENHAN TO QuanLy
GRANT ALL ON  TOATHUOC TO QuanLy
GRANT ALL ON  PHONGCHUCNANG TO QuanLy
GRANT ALL ON  PHIEUDIEUTRI TO QuanLy
GRANT ALL ON  KHOA TO QuanLy
GRANT ALL ON  NHACUNGCAP TO QuanLy
GRANT ALL ON  HOSOTHUOC TO QuanLy

--Khi hệ thống bảo trì, các quyền trên bảng TAIKHOAN của tất cả người dùng bị thu hồi
	REVOKE ALL ON TAIKHOAN FROM PUBLIC;


--4.7.2 BÁC SĨ, Y TÁ
--Tạo nhóm quyền
	CREATE ROLE BSIYTA 

--Cấp quyền cho nhóm
GRANT ALL ON  TAIKHOAN TO PUBLIC
GRANT SELECT, INSERT, UPDATE ON  HOSOBENHAN TO BSIYTA
GRANT ALL ON  TOATHUOC TO BSIYTA
GRANT ALL ON  PHIEUDIEUTRI TO BSIYTA
GRANT SELECT ON  HOSOTHUOC TO BSIYTA
GRANT SELECT ON  PHONGCHUCNANG TO BSIYTA
GRANT SELECT ON  KHOA TO BSIYTA
GRANT SELECT ON  NHACUNGCAP TO BSIYTA

--Tạo login
	CREATE LOGIN BacSi0 WITH PASSWORD = '123456'

--Tạo user snoww sử dụng login BacSi0
	CREATE USER snoww FOR LOGIN BacSi0

--Thêm user snoww vào nhóm BSIYTA
	Sp_AddRoleMember'BSIYTA', 'snoww'

--4.7.3 BỆNH NHÂN
--Tạo user cho người dùng là bệnh nhân
	CREATE LOGIN BenhNhanBV WITH PASSWORD = '55555', DEFAULT_DATABASE = QUANLYBENHVIEN
	CREATE USER BenhNhanBV for login BenhNhanBV

--Cấp quyền
	GRANT SELECT, UPDATE ON  HOSOBENHAN TO BenhNhanBV
	GRANT SELECT(MATHUOC,TENTHUOC,NGAYSX,NGAYHETHAN) ON  HOSOTHUOC TO BenhNhanBV
	GRANT SELECT, UPDATE ON BENHNHAN TO BenhNhanBV
	GRANT SELECT ON  HOADONVIENPHI TO BenhNhanBV
	GRANT SELECT ON  PHONGCHUCNANG TO BenhNhanBV
	GRANT SELECT ON  KHOA TO BenhNhanBV

--Thu hồi quyền UPDATE BENHNHAN của người dùng là bệnh nhân
	REVOKE UPDATE ON BENHNHAN FROM BenhNhanBV;


